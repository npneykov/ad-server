{% extends "admin/base.html" %}
{% block content %}
<h1>Ad Performance Leaderboard (last {{ days }} days)</h1>

<div class="card">
    <form method="get">
        <label>Window (days):
            <input type="number" name="days" value="{{ days }}" min="1" max="90" />
        </label>
        <button type="submit">Apply</button>
    </form>
</div>

<table id="leaderboard">
    <thead>
        <tr>
            <th>Rank</th>
            <th>Ad ID</th>
            <th>Zone</th>
            <th>Impressions</th>
            <th>Clicks</th>
            <th>CTR %</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for r in rows %}
        <tr>
            <td>{{ loop.index }}</td>
            <td>#{{ r.ad.id }}</td>
            <td>{{ r.zone.name }} ({{ r.zone.width }}Ã—{{ r.zone.height }})</td>
            <td>{{ r.imps }}</td>
            <td>{{ r.clks }}</td>
            <td>{{ "%.2f"|format(r.ctr) }}</td>
            <td>
                {% if r.active %}
                <span style="color:green">Active</span>
                {% else %}
                <span style="color:#a00">Disabled</span>
                {% endif %}
            </td>
            <td>
                {% if r.active %}
                <form method="post" action="/admin/ads/{{ r.ad.id }}/disable" style="display:inline">
                    <button type="submit">Disable</button>
                </form>
                {% else %}
                <form method="post" action="/admin/ads/{{ r.ad.id }}/enable" style="display:inline">
                    <button type="submit">Enable</button>
                </form>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<style>
    #leaderboard {
        width: 100%;
        border-collapse: collapse;
    }

    #leaderboard th,
    #leaderboard td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: center;
    }

    #leaderboard th {
        background: #f5f5f5;
    }
</style>
{% endblock %}
